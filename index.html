<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KT ìœ¼ëì°¨ì°¨íŒ¨í‚¤ì§€ ìš”ê¸ˆ ê³„ì‚°ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e5e7eb;
            font-size: 14px;
        }
        .summary-item:last-child {
            border-bottom: none;
        }
        .summary-title {
            color: #4b5563;
        }
        .summary-price {
            color: #1f2937;
            font-weight: 500;
        }
        .total-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1d4ed8;
        }
        .benefit-amount {
            font-size: 1.5rem;
            font-weight: 700;
            color: #059669;
        }
        [type='radio']:checked, [type='checkbox']:checked {
            background-color: #2563eb;
            border-color: #2563eb;
        }
        .option-label {
            display: block;
            padding: 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            position: relative;
        }
        .option-label:hover {
            border-color: #93c5fd;
            background-color: #eff6ff;
        }
        .option-label.selected {
            border-color: #2563eb;
            background-color: #dbeafe;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }
        .help-toggle {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 9999px;
            background-color: #9ca3af;
            color: white;
            font-weight: bold;
            font-size: 0.875rem;
            cursor: pointer;
            transition: background-color 0.2s;
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
        }
        .help-toggle:hover {
            background-color: #4b5563;
        }
        .promo-box {
            background-color: #eef2ff;
            border: 1px solid #c7d2fe;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-top: 1rem;
        }
        .script-box {
            background-color: #f3f4f6;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            font-size: 0.875rem;
            color: #374151;
            white-space: pre-wrap;
        }
        .copy-button {
            background-color: #2563eb;
            color: white;
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
            width: 100%;
            margin-top: 1rem;
        }
        .copy-button:hover {
            background-color: #1d4ed8;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-5xl">
        <div class="bg-white p-6 rounded-2xl shadow-lg mb-6">
            <div class="text-center">
                <h1 class="text-2xl md:text-3xl font-bold text-gray-900">KT ìœ¼ëì°¨ì°¨íŒ¨í‚¤ì§€ ìš”ê¸ˆ ê³„ì‚°ê¸°</h1>
                <p class="text-sm text-gray-500 mt-2">ë¬¸ì˜/ê°€ì…: 1588-0114</p>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Side: Options -->
            <div class="lg:col-span-2 space-y-6">
                
                <!-- Main Product Options -->
                <div class="bg-white p-6 rounded-2xl shadow-lg">
                    <h2 class="text-xl font-bold mb-4 border-b pb-2">1. ê¸°ë³¸ ìƒí’ˆ ì„ íƒ</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="font-semibold text-gray-700">ì¸í„°ë„·</label>
                            <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 mt-2" id="internet-options"></div>
                            <!-- WiFi Options section -->
                            <div id="wifi-options" class="mt-4"></div>
                        </div>
                        <div>
                            <label class="font-semibold text-gray-700">TV (ì„ íƒ)</label>
                            <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 mt-2" id="tv-options"></div>
                        </div>
                        <div>
                            <label class="font-semibold text-gray-700">ì „í™” (ì„ íƒ)</label>
                            <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 mt-2" id="phone-options"></div>
                        </div>
                         <!-- Installation Options -->
                        <div class="pt-4 border-t">
                            <label class="font-semibold text-gray-700">ì„¤ì¹˜ ì˜µì…˜</label>
                             <div class="flex items-center mt-2">
                                <input type="checkbox" id="weekend-install" name="weekend-install" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="calculateTotal()">
                                <label for="weekend-install" class="ml-2 block text-sm text-gray-900">ì£¼ë§ ì„¤ì¹˜ (í• ì¦ ì ìš©)</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Fixed IP -->
                <div class="bg-white p-6 rounded-2xl shadow-lg">
                     <h2 class="text-xl font-bold mb-4 border-b pb-2">2. ê³ ì •IP ì¶”ê°€ (ì„ íƒ)</h2>
                    <p class="text-sm text-gray-500 mb-4">ìì²´ ì„œë²„ ìš´ì˜, ì™¸ë¶€ CCTV ì ‘ì† ë“± íŠ¹ë³„í•œ ëª©ì ì´ ìˆì„ ë•Œ ì„ íƒí•©ë‹ˆë‹¤.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-2" id="fixed-ip-selector"></div>
                </div>

                <!-- Add-on Services -->
                <div class="bg-white p-6 rounded-2xl shadow-lg">
                    <h2 id="addon-title" class="text-xl font-bold mb-4 border-b pb-2">3. ì†Œìƒê³µì¸ ì†”ë£¨ì…˜ ì„ íƒ (ì„ íƒ)</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4" id="addon-services">
                        <!-- Checkbox addons will be populated here by JS -->
                    </div>
                     <!-- New CCTV Section -->
                    <div class="mt-4 p-4 border border-gray-200 rounded-xl relative">
                         <span class="help-toggle" data-key="addon-gigaeyes" title="ìƒì„¸ì •ë³´">?</span>
                         <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                            <div>
                                <span class="font-medium text-gray-800">GiGAeyes ì§€ëŠ¥í˜• CCTV</span>
                                <p class="text-xs text-gray-500 mt-1">1ëŒ€ 13,200ì› / 2ëŒ€ 24,200ì› / 3ëŒ€ 35,200ì› / 4ëŒ€ 46,200ì›</p>
                            </div>
                            <div class="flex items-center space-x-2 mt-3 sm:mt-0">
                                <label for="cctv-quantity" class="text-sm font-medium">ì„¤ì¹˜ ëŒ€ìˆ˜:</label>
                                <input type="number" id="cctv-quantity" name="cctv-quantity" min="0" value="0" class="w-20 text-center border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" onchange="calculateTotal()">
                            </div>
                        </div>
                        <p id="cctv-price-info" class="text-right text-sm font-semibold text-gray-700 mt-2"></p>
                    </div>
                </div>
            </div>

            <!-- Right Side: Summary -->
            <div class="lg:col-span-1">
                <div class="bg-white p-6 rounded-2xl shadow-lg sticky top-8">
                    <h2 class="text-xl font-bold mb-4 border-b pb-2 text-center">ê²¬ì  ìš”ì•½</h2>
                    <div id="summary" class="space-y-2 mb-4 min-h-[200px]"></div>
                    <div class="text-center pt-4 border-t-2 border-gray-300">
                        <p class="text-gray-600 font-semibold">ì›” ì˜ˆìƒ ìš”ê¸ˆ (VAT í¬í•¨)</p>
                        <p id="total-price" class="total-price mt-1">0ì›</p>
                    </div>
                    <div class="mt-4 text-center bg-green-50 p-3 rounded-lg border border-green-200">
                        <p class="text-green-800 font-semibold">ì˜ˆìƒ ì‚¬ì€í’ˆ í˜œíƒ</p>
                        <p id="benefit-amount" class="benefit-amount mt-1 text-base">0ì›</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Script Generation Section -->
        <div class="mt-8 bg-white p-6 rounded-2xl shadow-lg">
            <h2 class="text-2xl font-bold mb-6 text-center">ğŸ“„ ê³ ê° ì•ˆë‚´ ë¬¸ì ìŠ¤í¬ë¦½íŠ¸ (ìƒë‹´ì› ì°¸ê³ ìš©)</h2>
            <div class="space-y-6">
                <div>
                    <h3 class="text-lg font-bold mb-3">1. ìŠ¤í¬ë¦½íŠ¸ ì„ íƒ</h3>
                    <div id="script-selector" class="flex flex-wrap gap-3">
                        <label for="select-memo" class="flex-1 option-label text-center">
                            <input type="radio" id="select-memo" name="script-select" value="memo" class="hidden" checked>
                            ì „ì‚° ë©”ëª¨
                        </label>
                        <label for="select-product-info" class="flex-1 option-label text-center">
                            <input type="radio" id="select-product-info" name="script-select" value="product-info" class="hidden">
                            ìƒí’ˆ ì•ˆë‚´ ë¬¸ì
                        </label>
                        <label for="select-completion" class="flex-1 option-label text-center">
                            <input type="radio" id="select-completion" name="script-select" value="completion" class="hidden">
                            ê°€ì… ì™„ë£Œ ë¬¸ì
                        </label>
                    </div>
                </div>

                <div>
                    <h3 class="text-lg font-bold mb-2">2. ìŠ¤í¬ë¦½íŠ¸ ë‚´ìš©</h3>
                    <div id="script-memo-box" class="script-box"></div>
                    <div id="script-product-info-box" class="script-box hidden"></div>
                    <div id="script-completion-box" class="script-box hidden"></div>
                </div>
                
                <button id="copy-selected-script-button" class="copy-button">ì„ íƒí•œ ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬</button>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full">
            <div class="p-5 border-b flex justify-between items-center">
                <h3 id="modal-title" class="text-xl font-bold text-gray-800"></h3>
                <button id="modal-close" class="text-2xl text-gray-500 hover:text-gray-900">&times;</button>
            </div>
            <div id="modal-content" class="p-5 text-gray-700 leading-relaxed"></div>
        </div>
    </div>

    <script>
        // --- DATA ---
        const pricingData = {
            "internet": [
                { "name": "ì˜¤í”¼ìŠ¤ë„· ì„¸ì´ë¸Œ (100M)", "price": 30800 },
                { "name": "ì˜¤í”¼ìŠ¤ë„· ë² ì´ì§ (500M)", "price": 44000 },
                { "name": "ì˜¤í”¼ìŠ¤ë„· ì—ì„¼ìŠ¤ (1G)", "price": 49500 }
            ],
            "tv": [
                { "name": "Genie TV ë² ì´ì§ (236ì±„ë„)", "price": 15400, "setTopBox": "ê¸°ê°€ì§€ë‹ˆA" },
                { "name": "Genie TV ë¼ì´íŠ¸ (240ì±„ë„)", "price": 16500, "setTopBox": "ê¸°ê°€ì§€ë‹ˆA" },
                { "name": "Genie TV ì—ì„¼ìŠ¤ (266ì±„ë„)", "price": 19800, "setTopBox": "ê¸°ê°€ì§€ë‹ˆA" }
            ],
            "phone": [
                { "name": "ì¼ë°˜ ì „í™”", "price": 6050, "type": "general" },
                { "name": "ì¸í„°ë„· ì „í™” (070)", "price": 6294, "type": "voip" }
            ],
            "fixedIP": [
                { "name": "ê³ ì •IP (100M)", "price": 11000 },
                { "name": "ê³ ì •IP (500M)", "price": 22000 },
                { "name": "ê³ ì •IP (1G)", "price": 27500 }
            ],
            "addOns": [
                { "name": "ì¹´ë“œê²°ì œê¸° (VAN)", "price": 0, "description": "ì¸í„°ë„· ìš”ê¸ˆ 4,400ì› ì¶”ê°€ í• ì¸", "helpKey": "addon-van" },
                { "name": "í•˜ì´ì˜¤ë” (í…Œì´ë¸”ì˜¤ë”)", "price": 22000, "description": "ì¸í„°ë„· ìš”ê¸ˆ 5,500ì› ì¶”ê°€ í• ì¸", "helpKey": "addon-hiorder" },
            ],
            "installationFees": {
                "weekday": {
                    "internet_only": 36000,
                    "internet_tv": 56200,
                    "internet_general_phone": 68000,
                    "internet_voip_phone": 60000,
                    "internet_tv_general_phone": 88200,
                    "internet_tv_voip_phone": 80200
                },
                "weekend": {
                    "internet_only": 45000,
                    "internet_tv": 71250,
                    "internet_general_phone": 86000,
                    "internet_voip_phone": 78000,
                    "internet_tv_general_phone": 112250,
                    "internet_tv_voip_phone": 104250
                }
            },
             "discounts": {
                "phone_bundle": {
                    "speed_500m": 2200,
                    "speed_1g": 2200
                },
                "tv_bundle": {
                    "speed_500m": 5500,
                    "speed_1g": 5500
                }
            }
        };

        const benefitData = [
             { "condition": "100M_ë‹¨ë…", "benefit": 90000 },
             { "condition": "500M_ë‹¨ë…", "benefit": 140000 },
             { "condition": "1G_ë‹¨ë…", "benefit": 140000 },
             { "condition": "100M_TVê²°í•©", "benefit": 370000 },
             { "condition": "500M_TVê²°í•©", "benefit": 450000 },
             { "condition": "1G_TVê²°í•©", "benefit": 450000 }
        ];
        
        const helpTexts = { 
            'addon-van': { title: 'ì¹´ë“œê²°ì œê¸° (VAN)', content: `<p class="mb-2">ì œíœ´ ì¹´ë“œê²°ì œ ë‹¨ë§ê¸°(VAN)ë¥¼ ì¸í„°ë„·ê³¼ í•¨ê»˜ ì‚¬ìš©í•  ê²½ìš°, ì¸í„°ë„· ìš”ê¸ˆì—ì„œ ì§ì ‘ <strong>4,400ì›</strong>ì´ ì°¨ê° í• ì¸ë©ë‹ˆë‹¤.</p><p><strong>ì¡°ê±´:</strong></p><ul class="list-disc list-inside"><li>ì›” 1ê±´ ì´ìƒ ì¹´ë“œ ê²°ì œ ì‹¤ì ì´ í•„ìš”í•©ë‹ˆë‹¤.</li><li>ì›” 100ê±´ ì´ìƒ ì‚¬ìš© ì‹œ ë‹¨ë§ê¸° ë° ê´€ë¦¬ë¹„ê°€ ë©´ì œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ë³„ë„ ì¡°ê±´ í™•ì¸ í•„ìš”)</li><li>í• ì¸ì€ íŠ¹ì • ê°€ì… ì‹œì  ì´í›„ 36ê°œì›”ë¡œ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li></ul>` },
            'addon-hiorder': { title: 'í•˜ì´ì˜¤ë” (í…Œì´ë¸”ì˜¤ë”)', content: `<p class="mb-2">'í•˜ì´ì˜¤ë”'ì™€ ê°™ì€ í…Œì´ë¸” ì˜¤ë” ì†”ë£¨ì…˜ì„ ì¸í„°ë„·ê³¼ í•¨ê»˜ 'ìœ¼ëì°¨ì°¨ íŒ¨í‚¤ì§€'ë¡œ ë¬¶ì„ ê²½ìš°, ì¸í„°ë„· ìš”ê¸ˆì—ì„œ <strong>5,500ì›</strong>ì´ í• ì¸ë©ë‹ˆë‹¤.</p><p class="mb-3">ë˜í•œ, í•˜ì´ì˜¤ë” ìì²´ ìš”ê¸ˆë„ í• ì¸ëœ ê°€ê²©(ì›” 22,000ì›)ìœ¼ë¡œ ì œê³µë˜ì–´ ì´ì¤‘ í˜œíƒì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>` },
            'addon-gigaeyes': { title: 'GiGAeyes (CCTV)', content: '<p class="mb-2">ê³ í™”ì§ˆ ì¹´ë©”ë¼ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” ì§€ëŠ¥í˜• ì˜ìƒë³´ì•ˆ ì†”ë£¨ì…˜ì…ë‹ˆë‹¤. ì˜ìƒì„ ë§¤ì¥ ë‚´ê°€ ì•„ë‹Œ ì›ê²© í´ë¼ìš°ë“œ ì„œë²„ì— ì•ˆì „í•˜ê²Œ ì €ì¥í•˜ì—¬ í™”ì¬ë‚˜ ë„ë‚œ ì‹œì—ë„ ì˜ìƒ ìœ ì‹¤ ìœ„í—˜ì´ ì—†ìŠµë‹ˆë‹¤.</p><p>í”¼í”Œì¹´ìš´íŠ¸, íˆíŠ¸ë§µê³¼ ê°™ì€ ì§€ëŠ¥í˜• ì˜ìƒ ë¶„ì„ ê¸°ëŠ¥ìœ¼ë¡œ ë§ˆì¼€íŒ…ì— í™œìš©í•  ìˆ˜ ìˆìœ¼ë©°, KTí…”ë ˆìº… ì „ë¬¸ ì¶œë™ ì„œë¹„ìŠ¤ ë° ë³´ìƒ ë³´í—˜ ì—°ê³„ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>' }
        };

        // --- Elements ---
        const elements = {
            internetOptions: document.getElementById('internet-options'),
            wifiOptions: document.getElementById('wifi-options'),
            tvOptions: document.getElementById('tv-options'),
            phoneOptions: document.getElementById('phone-options'),
            fixedIpSelector: document.getElementById('fixed-ip-selector'),
            addonTitle: document.getElementById('addon-title'),
            addonServices: document.getElementById('addon-services'),
            summary: document.getElementById('summary'),
            totalPrice: document.getElementById('total-price'),
            benefitAmount: document.getElementById('benefit-amount'),
            helpModal: document.getElementById('help-modal'),
            modalTitle: document.getElementById('modal-title'),
            modalContent: document.getElementById('modal-content'),
            modalClose: document.getElementById('modal-close'),
            cctvQuantity: document.getElementById('cctv-quantity'),
            cctvPriceInfo: document.getElementById('cctv-price-info'),
            weekendInstall: document.getElementById('weekend-install'),
            scriptMemoBox: document.getElementById('script-memo-box'),
            scriptProductInfoBox: document.getElementById('script-product-info-box'),
            scriptCompletionBox: document.getElementById('script-completion-box'),
            scriptSelector: document.getElementById('script-selector'),
            copySelectedScriptButton: document.getElementById('copy-selected-script-button'),
        };

        let currentSelections = {};

        // --- Functions ---
        function createOption(type, name, value, title, price, isChecked = false) {
            const id = `${name}-${value.replace(/[\s\(\)]+/g, '-')}`;
            return `
                <label for="${id}" class="option-label ${isChecked ? 'selected' : ''}">
                    <input type="${type}" id="${id}" name="${name}" value="${value}" class="hidden" onchange="calculateTotal()" ${isChecked ? 'checked' : ''}>
                    <div class="text-center">
                        <span class="font-medium">${title}</span>
                        <span class="block text-xs text-gray-500">+${price.toLocaleString()}ì›</span>
                    </div>
                </label>`;
        }
        
        function createCheckbox(name, value, title, price, description, helpKey) {
            const id = `addon-${value.replace(/[\s\(\)]+/g, '-')}`;
            return `
                <label for="${id}" class="option-label flex items-start p-4">
                    <input type="checkbox" id="${id}" name="${name}" value="${value}" class="hidden" onchange="calculateTotal()">
                    <div class="flex-grow">
                        <span class="font-medium">${title}</span>
                        <p class="text-sm text-gray-600">+${price.toLocaleString()}ì›</p>
                        ${description ? `<p class="text-xs text-gray-500 mt-1">${description}</p>` : ''}
                    </div>
                    ${helpKey ? `<span class="help-toggle ml-2" data-key="${helpKey}" title="ìƒì„¸ì •ë³´">?</span>` : ''}
                </label>`;
        }

        function populateOptions() {
            // Populate basic options
            elements.internetOptions.innerHTML = pricingData.internet.map((s, i) => createOption('radio', 'internet', s.name, s.name, s.price, i === 0)).join('');
            elements.tvOptions.innerHTML = createOption('radio', 'tv', 'none', 'ì„ íƒ ì•ˆí•¨', 0, true) + pricingData.tv.map(s => createOption('radio', 'tv', s.name, `${s.name} + ${s.setTopBox}`, s.price)).join('');
            elements.phoneOptions.innerHTML = createOption('radio', 'phone', 'none', 'ì„ íƒ ì•ˆí•¨', 0, true) + pricingData.phone.map(s => createOption('radio', 'phone', s.name, s.name, s.price)).join('');
            elements.fixedIpSelector.innerHTML = createOption('radio', 'fixed-ip', 'none', 'ì„ íƒ ì•ˆí•¨', 0, true) + pricingData.fixedIP.map(s => createOption('radio', 'fixed-ip', s.name, s.name, s.price)).join('');
            
            // Populate add-ons
            elements.addonServices.innerHTML = pricingData.addOns.map(s => createCheckbox('addon', s.name, s.name, s.price, s.description, s.helpKey)).join('');
        }

        function calculateTotal() {
            // Preserve state of 100M router option before re-rendering
            const existingRouterChoice = document.querySelector('input[name="router-100m"]:checked')?.value || 'none';

            let total = 0;
            let preDiscountTotal = 0;
            let summaryHTML = '';
            currentSelections = { internet: null, tv: null, phone: null, fixedIP: null, addons: [], cctv: 0, router: null, totalPrice: 0, preDiscountPrice: 0, benefit: 0, installationFee: 0 };

            const getSelected = (name) => document.querySelector(`input[name="${name}"]:checked`)?.value;

            const selectedInternetName = getSelected('internet');
            const selectedTvName = getSelected('tv');
            const selectedPhoneName = getSelected('phone');
            const selectedFixedIpName = getSelected('fixed-ip');
            const selectedAddons = Array.from(document.querySelectorAll('input[name="addon"]:checked'));
            const cctvQuantity = parseInt(elements.cctvQuantity.value) || 0;
            const isWeekendInstall = elements.weekendInstall.checked;

            if (!selectedInternetName) return;

            // --- Base Prices ---
            const internetPlan = pricingData.internet.find(p => p.name === selectedInternetName);
            total += internetPlan.price;
            preDiscountTotal += internetPlan.price;
            summaryHTML += `<div class="summary-item"><span class="summary-title">${internetPlan.name}</span><span class="summary-price">+ ${internetPlan.price.toLocaleString()}ì›</span></div>`;
            currentSelections.internet = internetPlan.name;
            
            // --- WiFi Logic ---
            const wifiOptionsContainer = elements.wifiOptions;
            wifiOptionsContainer.innerHTML = ''; // Clear previous options

            if (internetPlan.name.includes('100M')) {
                const isRentChecked = existingRouterChoice === 'rent';
                const isNoneChecked = !isRentChecked;
                wifiOptionsContainer.innerHTML = `
                    <div>
                        <label class="font-semibold text-gray-700">ê³µìœ ê¸°</label>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 mt-2">
                            ${createOption('radio', 'router-100m', 'none', 'ì„ íƒ ì•ˆí•¨', 0, isNoneChecked)}
                            ${createOption('radio', 'router-100m', 'rent', 'ì¼ë°˜ ê³µìœ ê¸° ì„ëŒ€', 1100, isRentChecked)}
                        </div>
                    </div>`;
                
                const selectedRouter = document.querySelector('input[name="router-100m"]:checked').value;
                if (selectedRouter === 'rent') {
                    const routerFee = 1100;
                    total += routerFee;
                    preDiscountTotal += routerFee;
                    summaryHTML += `<div class="summary-item"><span class="summary-title">ì¼ë°˜ ê³µìœ ê¸° ì„ëŒ€</span><span class="summary-price">+ ${routerFee.toLocaleString()}ì›</span></div>`;
                    currentSelections.router = 'ì¼ë°˜ ê³µìœ ê¸° ì„ëŒ€';
                }
            } else if (internetPlan.name.includes('500M')) {
                wifiOptionsContainer.innerHTML = `
                    <div class="promo-box">
                        <p class="font-semibold text-blue-800">ğŸ ë¬´ë£Œ ì™€ì´íŒŒì´: GiGA WiFi home ax</p>
                        <p class="text-sm text-blue-700 mt-1">
                            <span class="font-bold">ã„´ í”„ë¡œëª¨ì…˜:</span> 'ë² ì´ì§(500Mbps)' ìš”ê¸ˆì œ ì‹ ê·œ ê°€ì… ì‹œ ë¬´ë£Œ ì œê³µ
                        </p>
                        <a href="https://product.kt.com/wDic/productDetail.do?ItemCode=1401" target="_blank" class="text-xs text-blue-600 hover:underline">ì œí’ˆ ìƒì„¸ ì •ë³´ &rarr;</a>
                    </div>`;
                currentSelections.router = 'GiGA WiFi home ax (ë¬´ë£Œ)';
            } else if (internetPlan.name.includes('1G')) {
                wifiOptionsContainer.innerHTML = `
                     <div class="promo-box">
                         <p class="font-semibold text-blue-800">ğŸ ë¬´ë£Œ ì™€ì´íŒŒì´: KT WiFi 7D</p>
                         <p class="text-sm text-blue-700 mt-1">
                             <span class="font-bold">ã„´ í”„ë¡œëª¨ì…˜:</span> 'ì—ì„¼ìŠ¤(1Gbps)' ì´ìƒ ìš”ê¸ˆì œ ì‹ ê·œ ê°€ì… ì‹œ ë¬´ë£Œ ì œê³µ (25ë…„ 8/31ê¹Œì§€, ì„ ì°©ìˆœ 5ë§Œëª…)
                         </p>
                         <a href="https://product.kt.com/wDic/productDetail.do?ItemCode=1633" target="_blank" class="text-xs text-blue-600 hover:underline">ì œí’ˆ ìƒì„¸ ì •ë³´ &rarr;</a>
                    </div>`;
                currentSelections.router = 'KT WiFi 7D (ë¬´ë£Œ)';
            }


            const tvPlan = pricingData.tv.find(p => p.name === selectedTvName);
            if (tvPlan) {
                total += tvPlan.price;
                preDiscountTotal += tvPlan.price;
                summaryHTML += `<div class="summary-item"><span class="summary-title">TV: ${tvPlan.name}</span><span class="summary-price">+ ${tvPlan.price.toLocaleString()}ì›</span></div>`;
                currentSelections.tv = tvPlan.name;
            }

            const phonePlan = pricingData.phone.find(p => p.name === selectedPhoneName);
            if (phonePlan) {
                total += phonePlan.price;
                preDiscountTotal += phonePlan.price;
                summaryHTML += `<div class="summary-item"><span class="summary-title">${phonePlan.name}</span><span class="summary-price">+ ${phonePlan.price.toLocaleString()}ì›</span></div>`;
                currentSelections.phone = phonePlan.name;
            }

            const fixedIpPlan = pricingData.fixedIP.find(p => p.name === selectedFixedIpName);
            if (fixedIpPlan) {
                total += fixedIpPlan.price;
                preDiscountTotal += fixedIpPlan.price;
                summaryHTML += `<div class="summary-item"><span class="summary-title">${fixedIpPlan.name}</span><span class="summary-price">+ ${fixedIpPlan.price.toLocaleString()}ì›</span></div>`;
                currentSelections.fixedIP = fixedIpPlan.name;
            }
            
            // --- Addon Logic ---
            if (selectedAddons.length > 0 || cctvQuantity > 0) {
                 summaryHTML += `<div class="summary-item pt-4 mt-2 border-t border-dashed"><span class="summary-title font-bold">ì†Œìƒê³µì¸ ì†”ë£¨ì…˜</span><span class="summary-price"></span></div>`;
            }

            selectedAddons.forEach(addonInput => {
                const addonName = addonInput.value;
                const addonPlan = pricingData.addOns.find(a => a.name === addonName);
                if (addonPlan) {
                    total += addonPlan.price;
                    preDiscountTotal += addonPlan.price;
                    summaryHTML += `<div class="summary-item"><span class="summary-title">${addonPlan.name}</span><span class="summary-price">+ ${addonPlan.price.toLocaleString()}ì›</span></div>`;
                    currentSelections.addons.push(addonName);
                }
            });

            // --- CCTV Logic ---
            if (cctvQuantity > 0) {
                let cctvTotal = 0;
                if (cctvQuantity === 1) cctvTotal = 13200;
                else if (cctvQuantity === 2) cctvTotal = 24200;
                else if (cctvQuantity === 3) cctvTotal = 35200;
                else if (cctvQuantity === 4) cctvTotal = 46200;
                else cctvTotal = 46200 + (cctvQuantity - 4) * 11000;
                
                total += cctvTotal;
                preDiscountTotal += cctvTotal;
                summaryHTML += `<div class="summary-item"><span class="summary-title">GiGAeyes CCTV (x${cctvQuantity})</span><span class="summary-price">+ ${cctvTotal.toLocaleString()}ì›</span></div>`;
                elements.cctvPriceInfo.textContent = `+ ${cctvTotal.toLocaleString()}ì›`;
                currentSelections.cctv = cctvQuantity;
            } else {
                elements.cctvPriceInfo.textContent = '';
            }

            // --- Discounts ---
            let totalDiscount = 0;
            let discountHTML = '';
            const internetSpeed = internetPlan.name.includes('100M') ? '100m' : internetPlan.name.includes('500M') ? '500m' : '1g';

            let bundleDiscount = 0;
            if (tvPlan && (internetSpeed === '500m' || internetSpeed === '1g')) {
                bundleDiscount = pricingData.discounts.tv_bundle[`speed_${internetSpeed}`];
                if(bundleDiscount) discountHTML += `<div class="summary-item"><span class="summary-title text-red-600">ì¸í„°ë„·+TV ê²°í•© í• ì¸</span><span class="summary-price text-red-600 font-semibold">- ${bundleDiscount.toLocaleString()}ì›</span></div>`;
            } else if (phonePlan && (internetSpeed === '500m' || internetSpeed === '1g')) {
                bundleDiscount = pricingData.discounts.phone_bundle[`speed_${internetSpeed}`];
                 if(bundleDiscount) discountHTML += `<div class="summary-item"><span class="summary-title text-red-600">ì¸í„°ë„·+ì „í™” ê²°í•© í• ì¸</span><span class="summary-price text-red-600 font-semibold">- ${bundleDiscount.toLocaleString()}ì›</span></div>`;
            }
            totalDiscount += bundleDiscount || 0;

            // Additional SOHO solution discounts
            if (currentSelections.addons.includes('ì¹´ë“œê²°ì œê¸° (VAN)')) {
                const vanDiscount = 4400;
                totalDiscount += vanDiscount;
                discountHTML += `<div class="summary-item"><span class="summary-title text-red-600">ì¹´ë“œê²°ì œê¸° ì—°ë™ í• ì¸</span><span class="summary-price text-red-600 font-semibold">- ${vanDiscount.toLocaleString()}ì›</span></div>`;
            }
            if (currentSelections.addons.includes('í•˜ì´ì˜¤ë” (í…Œì´ë¸”ì˜¤ë”)')) {
                const hiOrderDiscount = 5500;
                totalDiscount += hiOrderDiscount;
                discountHTML += `<div class="summary-item"><span class="summary-title text-red-600">í•˜ì´ì˜¤ë” ê²°í•© í• ì¸</span><span class="summary-price text-red-600 font-semibold">- ${hiOrderDiscount.toLocaleString()}ì›</span></div>`;
            }
            if (cctvQuantity > 0) {
                const gigaeyesDiscount = Math.round(internetPlan.price * 0.1);
                totalDiscount += gigaeyesDiscount;
                discountHTML += `<div class="summary-item"><span class="summary-title text-red-600">GiGAeyes ê²°í•© í• ì¸</span><span class="summary-price text-red-600 font-semibold">- ${gigaeyesDiscount.toLocaleString()}ì›</span></div>`;
            }

            if (totalDiscount > 0) {
                summaryHTML += `<div class="summary-item pt-4 mt-2 border-t border-dashed"><span class="summary-title font-bold text-red-600">ê²°í•© í• ì¸ ë‚´ì—­</span><span class="summary-price"></span></div>` + discountHTML;
            }
            
            total -= totalDiscount;

            // --- Installation Fee ---
            const feeSchedule = isWeekendInstall ? pricingData.installationFees.weekend : pricingData.installationFees.weekday;
            let installFee = 0;
            if (tvPlan && phonePlan) {
                installFee = phonePlan.type === 'general' ? feeSchedule.internet_tv_general_phone : feeSchedule.internet_tv_voip_phone;
            } else if (tvPlan) {
                installFee = feeSchedule.internet_tv;
            } else if (phonePlan) {
                installFee = phonePlan.type === 'general' ? feeSchedule.internet_general_phone : feeSchedule.internet_voip_phone;
            } else {
                installFee = feeSchedule.internet_only;
            }
            currentSelections.installationFee = installFee;
            summaryHTML += `<div class="summary-item pt-4 mt-2 border-t"><span class="summary-title font-bold">ì„¤ì¹˜ë¹„ (1íšŒ ì²­êµ¬)</span><span class="summary-price font-bold">+ ${installFee.toLocaleString()}ì›</span></div>`;


            // --- Benefit ---
            let benefitKey = internetPlan.name.includes('100M') ? '100M' : internetPlan.name.includes('500M') ? '500M' : '1G';
            benefitKey += tvPlan ? '_TVê²°í•©' : '_ë‹¨ë…';
            const benefit = benefitData.find(b => b.condition === benefitKey)?.benefit || 0;
            currentSelections.benefit = benefit;
            currentSelections.preDiscountPrice = preDiscountTotal;
            currentSelections.totalPrice = Math.max(0, total);


            // Update UI
            elements.summary.innerHTML = summaryHTML || `<p class="text-center text-gray-500 p-8">ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</p>`;
            elements.totalPrice.textContent = `${currentSelections.totalPrice.toLocaleString()}ì›`;
            elements.benefitAmount.textContent = `${benefit.toLocaleString()}ì›`;

            document.querySelectorAll('input[type="radio"], input[type="checkbox"]').forEach(input => {
                const label = input.closest('.option-label');
                if (label) {
                    label.classList.toggle('selected', input.checked);
                }
            });
            
            updateScripts();
        }
        
        function updateScripts() {
            if (!currentSelections.internet) return;

            // --- 1. Memo Script ---
            let products = [];
            if (currentSelections.internet) products.push(currentSelections.internet);
            if (currentSelections.tv) products.push(currentSelections.tv);
            if (currentSelections.phone) products.push(currentSelections.phone);
            if (currentSelections.router) products.push(currentSelections.router);
            if (currentSelections.fixedIP) products.push(currentSelections.fixedIP);
            if (currentSelections.addons.length > 0) products.push(...currentSelections.addons);
            if (currentSelections.cctv > 0) products.push(`GiGAeyes CCTV (x${currentSelections.cctv})`);

            const memoScript = `[KT ë¯¸ì†Œ ìƒë‹´ ë©”ëª¨]
1. ìƒí’ˆ : ${products.join(' + ')}
2. ìš”ê¸ˆ : (í• ì¸ì „)${currentSelections.preDiscountPrice.toLocaleString()}ì› / (í• ì¸í›„)${currentSelections.totalPrice.toLocaleString()}ì›
3. ì‚¬ì€í’ˆ ì´ì•¡ : ${currentSelections.benefit.toLocaleString()} ì› (ì˜ˆìƒ)
4. ì„¤ì¹˜ë¹„ : ${currentSelections.installationFee.toLocaleString()}ì›
6. ê¸°íƒ€ : ì´ì‚¬ ì—¬ë¶€ [ ] / í¬ë§ì„¤ì¹˜ì¼ì [    ë…„  ì›”  ì¼]

--- í•„ìˆ˜ ì•ˆë‚´ì‚¬í•­ ---
ê³ ê° ìƒí™©ì—ë”°ë¥¸ í•„ìˆ˜ì•ˆë‚´ì‚¬í•­ ì™„ë£Œ
1.  ê¸°ì¡´ ê°€ì¡± ë˜ëŠ” ë³¸ì¸ ëª…ì˜ íšŒì„  ìˆëŠ” ê²½ìš° ìœ ì§€ í•„ìš” ì•ˆë‚´ ì™„ë£Œ
2.  ì´ì‚¬ ê³ ê° Y / ì¶”í›„ ì†Œëª… ë°œìƒ ì‹œ ê´€ë ¨ ì„œë¥˜ ì œì¶œ ë™ì˜ ìˆ˜ê¸
3.  ì¸í„°ë„· ì„¤ì¹˜ í›„ ê³ ê°ì„¼í„°ë¡œ í›„ê²°í•© ìš”ì²­ ì•ˆë‚´ ì™„ë£Œ`;
            elements.scriptMemoBox.textContent = memoScript;

            // --- 2. Product Info Script ---
            const productInfoScript = `[ë¯¸ì†Œ] ìƒí’ˆ & ì‚¬ì€í’ˆ ìš”ì•½ ì•ˆë‚´
ì•ˆë…•í•˜ì„¸ìš”, ë¯¸ì†Œ ì¸í„°ë„· ì…ë‹ˆë‹¤.
ê³ ê°ë‹˜ê»˜ì„œ ì˜¤ëŠ˜ ìƒë‹´ ë°›ìœ¼ì‹  ìƒí’ˆ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.

[ìœ ì„  ìƒí’ˆ]
â–¶ï¸ ì¸í„°ë„·: ${currentSelections.internet || 'ë¯¸ì„ íƒ'}
â–¶ï¸ TV: ${currentSelections.tv || 'ë¯¸ì„ íƒ'}
â–¶ï¸ ì§‘ì „í™”: ${currentSelections.phone || 'ë¯¸ì„ íƒ'}
â–¶ï¸ ê³µìœ ê¸°: ${currentSelections.router || 'ë¯¸ì„ íƒ'}
${currentSelections.fixedIP ? `â–¶ï¸ ê³ ì •IP: ${currentSelections.fixedIP}` : ''}
${currentSelections.addons.length > 0 ? `â–¶ï¸ ë¶€ê°€ì„œë¹„ìŠ¤: ${currentSelections.addons.join(', ')}` : ''}
${currentSelections.cctv > 0 ? `â–¶ï¸ CCTV: GiGAeyes (x${currentSelections.cctv})` : ''}

[ìµœì¢… ìš”ê¸ˆ ë° í˜œíƒ]
â–¶ï¸ ì›” ${currentSelections.totalPrice.toLocaleString()}ì›
â–¶ï¸ ì‚¬ì€í’ˆ ${currentSelections.benefit.toLocaleString()} ì›

* ì„¤ì¹˜ë¹„ ${currentSelections.installationFee.toLocaleString()}ì› ì²« ë‹¬ 1íšŒ ì²­êµ¬ë©ë‹ˆë‹¤.
* í˜œíƒì€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°”ë€” ìˆ˜ ìˆë‹¤ëŠ” ì  ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.
* 3ë…„ ì•½ì • ê¸°ì¤€
ë¯¸ì†Œ ë“œë¦¼.`;
            elements.scriptProductInfoBox.textContent = productInfoScript;

            // --- 3. Completion Script ---
            const completionScript = `[ë¯¸ì†Œ] ê°€ì… ì™„ë£Œ ì•ˆë‚´
ì•ˆë…•í•˜ì„¸ìš”, ê³ ê°ë‹˜.
ë¯¸ì†Œ ì¸í„°ë„· ë¶€ì„œì…ë‹ˆë‹¤.
âœ… ê³„ì•½ì´ ì™„ë£Œë˜ì—ˆì–´ìš”, ì•„ë˜ ë‚´ìš©ì€ ê³„ì•½ì„œì™€ ë™ì¼í•œ íš¨ë ¥ì´ ìˆìœ¼ë‹ˆ ê¼¼ê¼¼íˆ ì½ì–´ì£¼ì„¸ìš”.
âš ï¸ 3ë…„ ì•½ì •ì´ë©°, ì•„ë˜ì™€ ê°™ì€ ìƒí™©ì— í•´ë‹¹í•˜ë©´ ë°›ìœ¼ì…¨ë˜ ì‚¬ì€í’ˆì€ í™˜ìˆ˜ ë©ë‹ˆë‹¤.
â‘  1ë…„ ì´ë‚´ í•´ì§€
â‘¡ 3ê°œì›” (90ì¼) ì´ìƒ ì •ì§€
â‘¢ 1ë…„ ì´ë‚´ ìš”ê¸ˆì œ í•˜í–¥ (ìƒí–¥ ì‹œì—ëŠ” í™˜ìˆ˜ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤!)
â‘£ 3ê°œì›” ì´ë‚´ ëª…ì˜ë³€ê²½
â‘¤ ê°œí†µ 1ê°œì›” ì´ë‚´ ê²°ì œìˆ˜ë‹¨ ì§€ë¡œì²­êµ¬ì„œë¡œ ë³€ê²½
âš ï¸ ì‹ ê·œ ê°€ì… í›„ ê¸°ì¡´ì— ì¸í„°ë„·ì€ ê¼­ í•´ì§€ í•´ì£¼ì„¸ìš”. ìë™í•´ì§€ë˜ì§€ ì•Šìœ¼ë©° ì´ëŸ´ ê²½ìš° ìš”ê¸ˆì´ ì´ì¤‘ ë¶€ê³¼ë˜ì–´ìš”.
âš ï¸ 3ë…„ ì´ë‚´ í•´ì§€ ì‹œ í†µì‹ ì‚¬ ë³¸ì‚¬ì— ìœ„ì•½ê¸ˆ (í• ì¸ ë°˜í™˜ê¸ˆ) ë° í†µì‹ ì‚¬ì— ë”°ë¼ ë©´ì œëœ ì™€ì´íŒŒì´ / í†µì‹ ê¸°ê¸° ì„¤ì¹˜ë¹„ ë°˜í™˜ì´ í•„ìš”í•  ìˆ˜ ìˆì–´ìš”.
âœ… ê°€ì… ìƒí’ˆ ì•ˆë‚´
â–¶ï¸ ${products.join(' + ')}
â–¶ï¸ ì›” ${currentSelections.totalPrice.toLocaleString()}ì› (ê²°í•© O)
â–¶ï¸ ì„¤ì¹˜ë¹„ ${currentSelections.installationFee.toLocaleString()}ì› ì²« ë‹¬ ë¶€ê³¼
â–¶ï¸ ì‚¬ì€í’ˆ ${currentSelections.benefit.toLocaleString()} ì›
âœ…ì‚¬ì€í’ˆì€ ì„¤ì¹˜ í›„ 7ì¼ ì´ë‚´ ìë™ìœ¼ë¡œ ì§€ê¸‰ë˜ë‚˜ í‰ì¼ê¸°ì¤€ 5ì‹œ ì´ì „ ê°œí†µ ë°›ì•˜ë‹¤ê³  ë¬¸ì ì£¼ì‹œë©´ ë‹¹ì¼ì…ê¸ˆ ë„ì›€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
[ë¯¸ì†Œë¥¼ ì†Œê°œí•´ì£¼ì„¸ìš”]
ì§€ì¸ì´ ë¯¸ì†Œì—ì„œ ì¸í„°ë„· ì„¤ì¹˜í•˜ë©´ ì†Œê°œí•´ì£¼ì‹  ë¶„ì—ê²Œ 3ë§Œì› ë“œë ¤ìš”.
â–¶ ì§€ì¸ì—ê²Œ ì¶”ì²œí•˜ê³  3O,OOOì› ë°›ê¸° (â†“)
https://get.miso.kr/pZbfsUPthzb
ë¯¸ì†Œ ì „ë‹´ ìƒë‹´ì‚¬ ê¹€í™ì‹ ë“œë¦¼.`;
            elements.scriptCompletionBox.textContent = completionScript;
        }
        
        function updateScriptDisplay() {
            const selectedValue = document.querySelector('input[name="script-select"]:checked').value;
            
            // Hide all script boxes
            elements.scriptMemoBox.classList.add('hidden');
            elements.scriptProductInfoBox.classList.add('hidden');
            elements.scriptCompletionBox.classList.add('hidden');

            // Show the selected one
            if (selectedValue === 'memo') {
                elements.scriptMemoBox.classList.remove('hidden');
            } else if (selectedValue === 'product-info') {
                elements.scriptProductInfoBox.classList.remove('hidden');
            } else if (selectedValue === 'completion') {
                elements.scriptCompletionBox.classList.remove('hidden');
            }

            // Update label styles
            document.querySelectorAll('input[name="script-select"]').forEach(radio => {
                radio.closest('.option-label').classList.toggle('selected', radio.checked);
            });
        }

        function openHelpModal(key) {
            const data = helpTexts[key];
            if (data) {
                elements.modalTitle.textContent = data.title;
                elements.modalContent.innerHTML = data.content;
                elements.helpModal.classList.remove('hidden');
            }
        }

        function closeHelpModal() { elements.helpModal.classList.add('hidden'); }
        
        function copySelectedScript() {
            const selectedValue = document.querySelector('input[name="script-select"]:checked').value;
            let textToCopy = '';
            
            if (selectedValue === 'memo') {
                textToCopy = elements.scriptMemoBox.textContent;
            } else if (selectedValue === 'product-info') {
                textToCopy = elements.scriptProductInfoBox.textContent;
            } else if (selectedValue === 'completion') {
                textToCopy = elements.scriptCompletionBox.textContent;
            }
            
            const textArea = document.createElement("textarea");
            textArea.value = textToCopy;
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                document.execCommand('copy');
                alert('ìŠ¤í¬ë¦½íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } catch (err) {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
            } finally {
                document.body.removeChild(textArea);
            }
        }

        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            populateOptions();
            calculateTotal();
            updateScriptDisplay(); // Initial display
            
            elements.scriptSelector.addEventListener('change', updateScriptDisplay);
            elements.copySelectedScriptButton.addEventListener('click', copySelectedScript);

            document.body.addEventListener('click', function(e) { 
                if (e.target.classList.contains('help-toggle')) {
                    const key = e.target.dataset.key;
                    openHelpModal(key);
                }
            });

            elements.modalClose.addEventListener('click', closeHelpModal);
            elements.helpModal.addEventListener('click', (e) => { if (e.target === elements.helpModal) closeHelpModal(); });
        });
    </script>
</body>
</html>
